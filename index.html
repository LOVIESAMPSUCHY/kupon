<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>NIESPODZIANKA DLA NARZECZONEJ </title>
<style>
  :root{
    --ink:#111; --bg1:#ffe3f2; --bg2:#ffd0ea;
    --pink:#ff4da6; --pink2:#ff85c2; --pink3:#ffc9e6;
    --cheek:#ff9bc9; --yellow:#ffcc00;
    --brand:#ff2f9c; --brand2:#ff6bb0;
    --shadow:0 10px 28px rgba(255,0,128,.35);
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; font-family:Inter,system-ui,Segoe UI,Roboto,Arial,sans-serif;
    background: radial-gradient(1200px 600px at 20% -10%, var(--bg1), var(--bg2) 60%, #ffc6e7 100%);
    display:grid; place-items:center; gap:14px; overflow:hidden; color:#333;
  }
  h1{margin:0; font-size:clamp(20px,4.5vw,28px); color:var(--brand); text-shadow:0 0 18px rgba(255,255,255,.7)}
  .hint{font-size:13px; color:#6b6b6b}

  /* Karta/scena */
  .card{
    background:rgba(255,255,255,.62); backdrop-filter:blur(8px);
    border:1px solid rgba(255,0,90,.12); border-radius:24px; box-shadow:var(--shadow);
    padding:22px 26px; text-align:center; width:min(580px,92vw);
  }

  /* HELLO KITTY (CSS) */
  .kitty{
    --w: 300px;
    position:relative; width:var(--w); height:calc(var(--w)*0.82);
    margin:0 auto 10px; cursor:pointer; user-select:none; -webkit-user-drag:none;
    animation:floaty 3s ease-in-out infinite;
    filter: drop-shadow(0 10px 24px rgba(255,0,128,.25));
  }
  @keyframes floaty{ 0%,100%{ transform:translateY(0) } 50%{ transform:translateY(-8px) } }
  .kitty:active{ transform:scale(.98) rotate(-1deg) }

  /* cie≈Ñ naklejki pod g≈ÇowƒÖ */
  .shadow-under{
    position:absolute; left:50%; bottom:-8%; transform:translateX(-50%);
    width:60%; height:16%; background:radial-gradient(ellipse at 50% 50%, rgba(0,0,0,.25), rgba(0,0,0,0) 70%);
    filter:blur(6px);
  }

  .head{
    position:absolute; inset:0; margin:auto;
    background:#fff; border:4px solid var(--ink);
    border-radius:48% 48% 52% 52% / 56% 56% 44% 44%;
  }
  .head::after{ /* po≈Çysk na g≈Çowie */
    content:""; position:absolute; left:8%; top:10%;
    width:48%; height:38%;
    background:radial-gradient(ellipse at 30% 30%, rgba(255,255,255,.9), rgba(255,255,255,.0) 60%);
    filter:blur(2px); border-radius:50%;
  }

  /* Uszy + wzmocnione wnƒôtrza i kontury */
  .ear{
    position:absolute; width:34%; height:42%; background:#fff; border:4px solid var(--ink);
    top:-14%; border-radius:28% 28% 0 0;
  }
  .ear.left{ left:2%; transform:rotate(-20deg) }
  .ear.right{ right:2%; transform:rotate(20deg) }
  .ear .inner{
    position:absolute; inset:22% 26% auto 26%; height:58%;
    background:linear-gradient(145deg,#ffd2ea,#ffabd4);
    border-radius:28% 28% 0 0; border:2px solid rgba(0,0,0,.28);
    box-shadow: inset 0 0 8px rgba(255,255,255,.8);
  }

  /* Oczy */
  .eye{
    position:absolute; width:7%; height:20%; background:#000; border-radius:50%;
    top:36%;
  }
  .eye.left{ left:28% }
  .eye.right{ right:28% }
  .eye::after{
    content:""; position:absolute; width:28%; height:28%; border-radius:50%;
    left:12%; top:14%; background:rgba(255,255,255,.8);
  }

  /* Nos */
  .nose{
    position:absolute; width:9.5%; height:12%;
    background:var(--yellow); border-radius:50%;
    border:3px solid var(--ink); top:53%; left:50%; transform:translateX(-50%);
  }

  /* WƒÖsy ‚Äì 3 na stronƒô */
  .whisker{
    position:absolute; height:2.4px; background:#000; width:22%;
    left:8%; top:44%;
    transform-origin:left center; opacity:.95;
  }
  .wh1{ transform:rotate(-14deg) }
  .wh2{ top:51%; transform:rotate(-4deg) }
  .wh3{ top:58%; transform:rotate(8deg) }
  .whisker.r{ left:auto; right:8%; transform-origin:right center }
  .r.wh1{ transform:rotate(14deg) }
  .r.wh2{ transform:rotate(4deg) }
  .r.wh3{ transform:rotate(-8deg) }

  /* Policzki */
  .cheek{
    position:absolute; width:15%; height:15%; border-radius:50%;
    background:radial-gradient(circle at 50% 50%, var(--cheek), rgba(255,155,201,0.55) 55%, rgba(255,155,201,0.0) 70%);
    filter:blur(.4px); top:56%;
  }
  .cheek.left{ left:18% } .cheek.right{ right:18% }

  /* Kokardka */
  .bow{ position:absolute; right:-4%; top:6%; width:38%; height:36% }
  .loop{
    position:absolute; width:48%; height:58%; top:22%;
    background:linear-gradient(145deg,#ff77b8,#ff3fa2);
    border:3px solid var(--ink); border-radius:50%;
    box-shadow: inset 0 0 10px rgba(255,255,255,.65);
  }
  .loop.left{ left:2%; transform:rotate(-12deg) }
  .loop.right{ right:2%; transform:rotate(12deg) }
  .knot{
    position:absolute; left:50%; top:44%; transform:translate(-50%,-50%);
    width:26%; height:26%; background:linear-gradient(145deg,#ff8fc8,#ff4da6);
    border-radius:50%; border:3px solid var(--ink);
    box-shadow: inset 0 0 10px rgba(255,255,255,.75);
  }
  .knot::after{
    content:""; position:absolute; left:22%; top:22%;
    width:38%; height:38%; border-radius:50%;
    background:radial-gradient(circle, rgba(255,255,255,.95), rgba(255,255,255,0) 70%);
  }

  /* Modale */
  .modal{
    position:fixed; inset:0; display:grid; place-items:center; padding:18px;
    background:rgba(0,0,0,.42); opacity:0; pointer-events:none; transition:opacity .25s ease; z-index:5;
  }
  .modal.active{ opacity:1; pointer-events:auto }
  .sheet{
    position:relative; width:min(580px,94vw); padding:24px 26px 20px;
    background:linear-gradient(145deg,#fff0f8,#ffd8eb,#ffb6db);
    border-radius:22px; border:2.5px dashed #ff86b3; text-align:center; box-shadow:var(--shadow);
    animation:pop .35s ease;
  }
  @keyframes pop{ 0%{transform:scale(.86); opacity:0} 100%{transform:scale(1); opacity:1} }
  .sheet::before,.sheet::after{
    content:""; position:absolute; top:50%; transform:translateY(-50%); width:26px; height:26px;
    background:radial-gradient(circle at 50% 50%, transparent 60%, #ff86b3 61% 64%, transparent 65%);
  }
  .sheet::before{ left:-14px } .sheet::after{ right:-14px }
  .gloss{
    position:absolute; left:0; right:0; top:0; height:48%;
    background:linear-gradient(180deg, rgba(255,255,255,.65), rgba(255,255,255,0));
    border-radius:22px 22px 0 0; pointer-events:none;
  }
  .sheet h2{ margin:2px 0 6px; color:var(--brand); font-size:clamp(20px,4.4vw,28px); text-shadow:0 0 12px rgba(255,100,180,.55) }
  .sheet p{ margin:6px 0; color:#333 }
  .perk{ font-weight:800; color:var(--brand); margin:8px 0; font-size:clamp(16px,4.4vw,20px) }
  .btns{ display:flex; gap:10px; justify-content:center; flex-wrap:wrap; margin-top:12px }
  .btn{
    border:0; padding:10px 14px; border-radius:12px; cursor:pointer; font-weight:700;
    background:linear-gradient(145deg,var(--brand2),#ff94c9,#ffd0eb); color:#fff; box-shadow:0 6px 18px rgba(255,0,128,.35);
  }
  .btn.secondary{ background:#f3f4f6; color:#333; box-shadow:none; border:1px solid #e6e6e6 }

  /* Serduszka */
  .heart{ position:fixed; width:18px; height:18px; pointer-events:none; animation:fly 1.6s ease forwards; z-index:6 }
  .heart::before{ content:"üíñ"; font-size:18px; text-shadow:0 0 8px #fff; display:block }
  @keyframes fly{ 0%{ transform:translateY(0) scale(.6); opacity:1 } 100%{ transform:translateY(-220px) scale(1.6); opacity:0 } }

  /* Canvas konfetti */
  #fx{ position:fixed; inset:0; pointer-events:none; z-index:6 }
</style>
</head>
<body>
  <canvas id="fx"></canvas>

  <div class="card">
    <!-- Postaƒá Hello Kitty -->
    <div class="kitty" id="kitty" aria-label="Hello Kitty ‚Äì kliknij, aby odebraƒá kupon">
      <div class="shadow-under"></div>
      <div class="head"></div>

      <div class="ear left"><div class="inner"></div></div>
      <div class="ear right"><div class="inner"></div></div>

      <div class="eye left"></div>
      <div class="eye right"></div>

      <div class="nose"></div>

      <div class="whisker wh1"></div>
      <div class="whisker wh2"></div>
      <div class="whisker wh3"></div>

      <div class="whisker r wh1"></div>
      <div class="whisker r wh2"></div>
      <div class="whisker r wh3"></div>

      <div class="cheek left"></div>
      <div class="cheek right"></div>

      <div class="bow">
        <div class="loop left"></div>
        <div class="loop right"></div>
        <div class="knot"></div>
      </div>
    </div>

    <h1>Kliknij Hello Kitty üéÄ</h1>
    <div class="hint">‚Ä¶i odbierz <b>Niespodzianke</b> üíï</div>

    <div class="btns" style="margin-top:12px;">
      <button class="btn" id="openCoupon">Poka≈º kupon</button>
      <button class="btn secondary" id="openApology">Poka≈º przeprosiny</button>
    </div>
  </div>

  <!-- KU P O N -->
  <div class="modal" id="couponModal">
    <div class="sheet" role="dialog" aria-modal="true">
      <div class="gloss"></div>
      <h2>üéÄ Kupon Milosny üéÄ</h2>
      <p>Ten kupon uprawnia Ciƒô do:</p>
      <div class="perk">üíñ NIELIMITOWANYCH PRZYTULAS√ìW</div>
      <div class="perk">üíã NIELIMITOWANYCH POCA≈ÅUNK√ìW</div>
      <p>Wa≈ºny: <b>NA ZAWSZE</b> ‚Ä¢ Dla: <b id="nameTo">Natalii</b> ‚Ä¢ Od: <b id="nameFrom">Mateusza</b></p>
      <div class="btns">
        <button class="btn" id="savePng">Zapisz kupon jako GRAFIKE</button>
        <button class="btn secondary" id="closeCoupon">Zamknij</button>
      </div>
    </div>
  </div>

  <!-- P R Z E P R O S I N Y -->
  <div class="modal" id="apologyModal">
    <div class="sheet" role="dialog" aria-modal="true">
      <div class="gloss"></div>
      <h2>üíó Przepraszam</h2>
      <p style="font-size:16px; line-height:1.55">
        <b>Natalia</b> przepraszam Ciƒô za to co ostatnio za g≈Çupoty gada≈Çem. 
        Wiem, ≈ºe cie tym zrani≈Çem zale≈ºy mi na tobie strasznie i nie chcia≈Çem sprawiƒá ci przykro≈õci. 
        Bo ufam ci jak nikomu innemu nigdy nie zaufalem znasz mnie najlepiej dziekuje ci ze jestes i za wszystko co dla mnie robisz.
        <br><br>
        Kocham Ciƒô Bardzo ‚Äì <b>Mateusz</b> üíû
      </p>
      <div class="btns">
        <button class="btn" id="acceptApology">Przyjmij przeprosiny</button>
        <button class="btn secondary" id="closeApology">Zamknij</button>
      </div>
    </div>
  </div>

<script>
  /* === KONFIG === */
  const RECEIVER_NAME = "Natalia";
  const SENDER_NAME   = "Mateusz";

  /* === ELEMENTY === */
  const fx = document.getElementById('fx');
  const kitty = document.getElementById('kitty');
  const openCouponBtn = document.getElementById('openCoupon');
  const openApologyBtn = document.getElementById('openApology');

  const couponModal = document.getElementById('couponModal');
  const apologyModal = document.getElementById('apologyModal');
  const closeCoupon = document.getElementById('closeCoupon');
  const closeApology = document.getElementById('closeApology');
  const savePng = document.getElementById('savePng');
  const acceptApology = document.getElementById('acceptApology');

  // Wstaw imiona
  document.getElementById('nameTo').textContent = RECEIVER_NAME + " ";
  document.getElementById('nameFrom').textContent = SENDER_NAME + " ";

  /* === AUDIO POP (WebAudio) === */
  let actx;
  function ensureAudio(){
    if(!actx){
      actx = new (window.AudioContext || window.webkitAudioContext)();
    }
    if(actx.state === 'suspended') actx.resume();
  }
  function popSound(){
    ensureAudio();
    const osc = actx.createOscillator();
    const gain = actx.createGain();
    osc.type = 'sine';
    osc.frequency.setValueAtTime(620, actx.currentTime);
    osc.frequency.exponentialRampToValueAtTime(240, actx.currentTime + 0.12);
    gain.gain.setValueAtTime(0.0001, actx.currentTime);
    gain.gain.exponentialRampToValueAtTime(0.25, actx.currentTime + 0.02);
    gain.gain.exponentialRampToValueAtTime(0.0001, actx.currentTime + 0.16);
    osc.connect(gain).connect(actx.destination);
    osc.start(); osc.stop(actx.currentTime + 0.18);
  }

  /* === HEARTS === */
  function spawnHearts(x, y, n=18){
    const vw = Math.max(document.documentElement.clientWidth || 0, window.innerWidth || 0);
    const vh = Math.max(document.documentElement.clientHeight || 0, window.innerHeight || 0);
    for(let i=0;i<n;i++){
      const h = document.createElement('div');
      h.className = 'heart';
      const angle = Math.random()*Math.PI*2;
      const r = 18 + Math.random()*36;
      const hx = x + Math.cos(angle)*r;
      const hy = y + Math.sin(angle)*r;
      h.style.left = Math.min(Math.max(10, hx), vw-10) + 'px';
      h.style.top  = Math.min(Math.max(10, hy), vh-10) + 'px';
      h.style.animationDuration = (1.1 + Math.random()*0.9) + 's';
      h.style.transform = `translateY(${Math.random()*10-5}px) scale(${0.7 + Math.random()*1.1})`;
      document.body.appendChild(h);
      setTimeout(()=>h.remove(), 1900);
    }
  }

  /* === CONFETTI (canvas) === */
  const ctx = fx.getContext('2d');
  function resizeFx(){ fx.width = innerWidth; fx.height = innerHeight }
  addEventListener('resize', resizeFx); resizeFx();

  function confetti(x,y,count=120){
    const parts = [];
    for(let i=0;i<count;i++){
      parts.push({
        x, y,
        vx: (Math.random()*2-1)*3.2,
        vy: - (2 + Math.random()*3.5),
        g: 0.065 + Math.random()*0.04,
        s: 2 + Math.random()*3,
        a: 1,
        rot: Math.random()*Math.PI,
        vr: (Math.random()*2-1)*0.2,
        color: pick(['#ff2f9c','#ff6bb0','#ffd0eb','#ffffff','#ffd166','#c3f0ff'])
      });
    }
    const t0 = performance.now();
    function frame(now){
      const dt = Math.min(32, now - (frame._prev||now)); frame._prev = now;
      ctx.clearRect(0,0,fx.width,fx.height);
      for(const p of parts){
        p.vx *= 0.995; p.vy += p.g; p.x += p.vx; p.y += p.vy;
        p.rot += p.vr; p.a *= 0.992;
        ctx.save();
        ctx.globalAlpha = Math.max(0, p.a);
        ctx.translate(p.x, p.y);
        ctx.rotate(p.rot);
        ctx.fillStyle = p.color;
        ctx.fillRect(-p.s, -p.s/2, p.s*2, p.s);
        ctx.restore();
      }
      if(now - t0 < 1800){ requestAnimationFrame(frame); }
      else { ctx.clearRect(0,0,fx.width,fx.height); }
    }
    requestAnimationFrame(frame);
  }
  function pick(arr){ return arr[(Math.random()*arr.length)|0]; }

  /* === ZAPIS KUPONU DO PNG (rysowany rƒôcznie na canvasie) === */
  function saveCouponAsPNG(){
    const W=1080, H=720, pad=40, rx=30;
    const c=document.createElement('canvas'); c.width=W; c.height=H;
    const g=c.getContext('2d');

    // T≈Ço
    const grad = g.createLinearGradient(0,0,W,H);
    grad.addColorStop(0, '#fff0f8'); grad.addColorStop(1, '#ffd1e8');
    g.fillStyle=grad; g.fillRect(0,0,W,H);

    // Bilet
    roundRect(g, pad, pad, W-2*pad, H-2*pad, rx);
    g.fillStyle='#ffffff'; g.fill();
    g.lineWidth=8; g.setLineDash([18,16]); g.strokeStyle='#ff86b3'; g.stroke();

    // Pasek po≈Çysku
    g.setLineDash([]); g.globalAlpha=0.5;
    roundRect(g, pad, pad, W-2*pad, (H-2*pad)*0.45, rx);
    g.clip();
    const gloss=g.createLinearGradient(0,pad,0,pad+(H-2*pad)*0.45);
    gloss.addColorStop(0,'rgba(255,255,255,0.75)'); gloss.addColorStop(1,'rgba(255,255,255,0)');
    g.fillStyle=gloss; g.fillRect(pad,pad,W-2*pad,(H-2*pad)*0.45);
    g.restore(); g.globalAlpha=1;

    // Teksty
    g.fillStyle = '#ff2f9c'; g.font='bold 54px Inter, Arial, sans-serif'; g.textAlign='center';
    g.fillText('üéÄ Kupon Mi≈Ço≈õci üéÄ', W/2, 150);

    g.fillStyle='#333'; g.font='28px Inter, Arial, sans-serif';
    g.fillText('Ten kupon uprawnia Ciƒô do:', W/2, 230);

    g.fillStyle='#ff2f9c'; g.font='bold 42px Inter, Arial, sans-serif';
    g.fillText('üíñ NIELIMITOWANYCH PRZYTULAS√ìW', W/2, 320);
    g.fillText('üíã NIELIMITOWANYCH POCA≈ÅUNK√ìW', W/2, 380);

    g.fillStyle='#555'; g.font='26px Inter, Arial, sans-serif';
    g.fillText(`Wa≈ºny: na zawsze  |  Dla: ${RECEIVER_NAME}  |  Od: ${SENDER_NAME}`, W/2, 460);

    // Ozdobne serduszka
    for(let i=0;i<22;i++){ drawHeart(g, 80 + Math.random()*(W-160), 560 + Math.random()*110, 10 + Math.random()*14); }

    const url=c.toDataURL('image/png');
    const a=document.createElement('a'); a.href=url; a.download='Kupon_Milosci_od_' + SENDER_NAME + '.png'; a.click();
  }
  function roundRect(ctx,x,y,w,h,r){
    ctx.save(); ctx.beginPath();
    ctx.moveTo(x+r,y); ctx.arcTo(x+w,y,x+w,y+h,r);
    ctx.arcTo(x+w,y+h,x,y+h,r); ctx.arcTo(x,y+h,x,y,r); ctx.arcTo(x,y,x+w,y,r);
    ctx.closePath(); ctx.restore();
  }
  function drawHeart(ctx, x, y, s){
    ctx.save(); ctx.translate(x,y); ctx.rotate(-Math.PI/4);
    ctx.fillStyle='#ff6aa0'; ctx.beginPath();
    ctx.moveTo(0,0);
    ctx.quadraticCurveTo(0,-s, s,-s);
    ctx.quadraticCurveTo(2*s,-s, 2*s,0);
    ctx.quadraticCurveTo(2*s,s, s,2*s);
    ctx.quadraticCurveTo(0,s, 0,0);
    ctx.fill(); ctx.restore();
  }

  /* === INTERAKCJE === */
  function openCoupon(e){
    couponModal.classList.add('active');
    const {clientX:x=innerWidth/2, clientY:y=innerHeight/2} = e || {};
    spawnHearts(x,y,22); confetti(x,y,140); popSound();
  }
  function openApology(e){
    apologyModal.classList.add('active');
    const {clientX:x=innerWidth/2, clientY:y=innerHeight/2} = e || {};
    spawnHearts(x,y,18); confetti(x,y,120); popSound();
  }

  kitty.addEventListener('click', openCoupon);
  openCouponBtn.addEventListener('click', openCoupon);
  openApologyBtn.addEventListener('click', openApology);

  closeCoupon.addEventListener('click', ()=> couponModal.classList.remove('active'));
  closeApology.addEventListener('click', ()=> apologyModal.classList.remove('active'));

  // Zamkniƒôcie klikniƒôciem t≈Ça
  couponModal.addEventListener('click', e=>{ if(e.target===couponModal) couponModal.classList.remove('active') });
  apologyModal.addEventListener('click', e=>{ if(e.target===apologyModal) apologyModal.classList.remove('active') });

  // Przyciski akcji
  savePng.addEventListener('click', ()=>{ popSound(); saveCouponAsPNG(); });
  acceptApology.addEventListener('click', (e)=>{
    const rect = e.target.getBoundingClientRect();
    const x = rect.left + rect.width/2, y = rect.top + rect.height/2;
    spawnHearts(x,y,26); confetti(x,y,180); popSound();
  });
</script>
</body>
</html>
